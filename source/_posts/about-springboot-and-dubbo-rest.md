---
title: 关于Spring Boot与Dubbo REST
date: 2017-07-08 18:44:05
tags: 
  - Spring Boot
  - Dubbo
  - REST
---

## 关于Spring Boot

Spring Boot的设计目的是用来简化新Spring应用的初始搭建以及开发过程。该框架使用了特定的方式来进行配置，从而使开发人员不再需要定义样板化的配置。通过这种方式，Spring Boot致力于在蓬勃发展的快速应用开发领域成为领导者。

<!-- more -->

Spring Boot(英文中是“引导”的意思)，是用来简化Spring应用的搭建到开发的过程。应用开箱即用，只要通过 “just run”（可能是 java -jar 或 tomcat 或 maven插件run 或 shell脚本），就可以启动项目。二者，Spring Boot 只要很少的Spring配置文件（例如那些xml，property）。

因为“习惯优先于配置”的原则，使得Spring Boot在快速开发应用和微服务架构实践中得到广泛应用。

## Spring Boot整合Dubbo实现SOA

Spring Boot对于作为微服务的框架来说

优点：

- 嵌入式Tomcat、Jetty容器，无需部署war包
- 遵循"习惯优于配置"原则，只需很少的配置，大部分时候可以使用默认配置
- 项目快速搭建
- 丰富的和第三方框架无配置整合的jar包

缺点：

- 坑有些多, 文档略少
- 简单的背后蕴藏了较大的学习曲线

Dubbo是一个分布式服务框架，致力于提供高性能和透明化的RPC远程服务调用方案，是阿里巴巴SOA服务化治理方案的核心框架，有以下几个特性

- 远程通信，向本地调用一样调用远程方法。
- 集群容错
- 服务自动发现和注册，可平滑添加或者删除服务提供者。

一般而言，我们常常暴露HTTP服务，并走JSON模式。但慢慢量大了，缺少一种SOA的治理方案。之后整合Dubbo服务治理方案实现SOA，这样可以暴露出Dubbo服务接口，提供给Dubbo消费者进行RPC调用。

可以看出，Dubbo才是应用服务化绝对的核心，在这过程中，Spring Boot扮演为Dubbo提供服务启动初始化入口，整合各种第三方框架，为Dubbo服务提供各组件支持的角色

所以，Spring Boot在已经部署Dubbo服务的情况下，只作为容器来说没有必要使用

---

## Dubbo服务的开放

### 概述与应用场景

以REST为例

Dubbo支持多种远程调用方式，基于简单的文本格式消息和通用的HTTP协议，使它具备极广的适用性，几乎所有语言和平台都对它提供支持，同时其学习和使用的门槛也较低。

在dubbo中支持REST，可以为当今多数主流的远程调用场景都带来（显著）好处：

> 显著简化企业内部的异构系统之间的（跨语言）调用。此处主要针对这种场景：dubbo的系统做服务提供端，其他语言的系统（也包括某些不基于dubbo的java系统）做服务消费端，两者通过HTTP和文本消息进行通信。即使相比Thrift、ProtoBuf等二进制跨语言调用方案，REST也有自己独特的优势（详见后面讨论）

> 显著简化对外Open API（开放平台）的开发。既可以用dubbo来开发专门的Open API应用，也可以将原内部使用的dubbo service直接“透明”发布为对外的Open REST API（当然dubbo本身未来最好可以较透明的提供诸如权限控制、频次控制、计费等诸多功能）

> 显著简化手机（平板）APP或者PC桌面客户端开发。类似于2，既可以用dubbo来开发专门针对无线或者桌面的服务器端，也可以将原内部使用的dubbo service直接”透明“的暴露给手机APP或桌面程序。当然在有些项目中，手机或桌面程序也可以直接访问以上场景2中所述的Open API。

> 显著简化浏览器AJAX应用的开发。类似于2，既可以用dubbo来开发专门的AJAX服务器端，也可以将原内部使用的dubbo service直接”透明“的暴露给浏览器中JavaScript。当然，很多AJAX应用更适合与web框架协同工作，所以直接访问dubbo service在很多web项目中未必是一种非常优雅的架构。

> 为企业内部的dubbo系统之间（即服务提供端和消费端都是基于dubbo的系统）提供一种基于文本的、易读的远程调用方式。

> 一定程度简化dubbo系统对其它异构系统的调用。可以用类似dubbo的简便方式“透明”的调用非dubbo系统提供的REST服务（不管服务提供端是在企业内部还是外部）

> **需要指出的是，我认为1～3是dubbo的REST调用最有价值的三种应用场景，并且我们为dubbo添加REST调用，其最主要到目的也是面向服务的提供端，即开发REST服务来提供给非dubbo的（异构）消费端。**

### 一些问题

Dubbo REST的服务能和Dubbo注册中心、监控中心集成吗？

> 可以的，而且是自动集成的，也就是你在dubbo中开发的所有REST服务都会自动注册到服务册中心和监控中心，可以通过它们做管理。

> 但是，只有当REST的消费端也是基于dubbo的时候，注册中心中的许多服务治理操作才能完全起作用。而如果消费端是非dubbo的，自然不受注册中心管理，所以其中很多操作是不会对消费端起作用的。

Dubbo REST中如何实现负载均衡和容错（failover）？

> 如果dubbo REST的消费端也是dubbo的，则Dubbo REST和其他dubbo远程调用协议基本完全一样，由dubbo框架透明的在消费端做load balance、failover等等。

> 如果dubbo REST的消费端是非dubbo的，甚至是非java的，则最好配置服务提供端的软负载均衡机制，目前可考虑用LVS、HAProxy、 Nginx等等对HTTP请求做负载均衡。